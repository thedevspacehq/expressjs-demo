extends layout.pug 

block meta
  title Home

block content 

  form(id="myForm")
    label(for="username") Username:
    input(type="text", name="username", id="username", value="")
    label(for="email") Email:
    input(type="email", name="email", id="email", value="")
    label(for="picture") Picture: 
    input(type="file", name="picture", id="picture", value="")
    input(type="submit", value="Submit")

  script.
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('myForm');
        const usernameInput = document.getElementById('username');
        const emailInput = document.getElementById('email');
        const pictureInput = document.getElementById('picture');

        const formData = new FormData();

        usernameInput.addEventListener('input', function() {
            formData.set('username', usernameInput.value);
            //- for (const pair of formData.entries()) {
            //-   console.log(pair[0], pair[1]);
            //- }
        });

        emailInput.addEventListener('input', function() {
            formData.set('email', emailInput.value);
        });

        pictureInput.addEventListener('change', function() { // Listen for file change
            formData.set('picture', pictureInput.files[0]); // Set the file in FormData
            for (const pair of formData.entries()) {
              console.log(pair[0], pair[1]);
            }
        });

        form.addEventListener('submit', async function(event) {
            event.preventDefault(); // Prevent the default form submission

            await fetch('/users', {
                method: 'POST',
                body: formData,
                headers: {
                    'Content-Type': 'multipart/form-data'
                }
            })
        });
    });

